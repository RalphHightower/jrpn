import 'dart:convert';

import 'package:flutter_test/flutter_test.dart';

import 'programs.dart';

const state16C = [
  '''{
    "comments": null,
    "version": 1,
    "settings": {
        "menuEnabled": false,
        "windowEnabled": true,
        "euroComma": false,
        "hideComplement": false,
        "showWordSize": false,
        "showAccelerators": false,
        "systemOverlaysDisabled": false,
        "orientation": 0,
        "traceProgramToStdout": false
    },
    "displayMode": "f4",
    "integerSignMode": "2",
    "wordSize": 56,
    "stack": [
        "1234567898000",
        "1234567898000",
        "1234567890000",
        "1234567890000"
    ],
    "lastX": "0",
    "flags": [
        false,
        false,
        false,
        false,
        false,
        false
    ],
    "memory": {
        "storage": "000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f909192939495969798999a9b9c9d9e9fa0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebfc0c1c2c3c4c5c6c7c8c9ca",
        "program": {
            "lines": 203,
            "currentLine": 0,
            "returnStack": [
                0,
                0,
                0,
                0
            ],
            "returnStackPos": -1
        },
        "I": "0",
        "commentProgramListing": [
            "001 --        0    0x00  0",
            "002 --        1    0x01  1",
            "003 --        2    0x02  2",
            "004 --        3    0x03  3",
            "005 --        4    0x04  4",
            "006 --        5    0x05  5",
            "007 --        6    0x06  6",
            "008 --        7    0x07  7",
            "009 --        8    0x08  8",
            "010 --        9    0x09  9",
            "011 --        a    0x0a  A",
            "012 --        b    0x0b  B",
            "013 --        c    0x0c  C",
            "014 --        d    0x0d  D",
            "015 --        e    0x0e  E",
            "016 --        f    0x0f  F",
            "017 --    42  a    0x10  SL",
            "018 --    43  a    0x11  LJ",
            "019 --    42  b    0x12  SR",
            "020 --    43  b    0x13  ASR",
            "021 --    42  c    0x14  RL",
            "022 --    43  c    0x15  RLC",
            "023 --    42  d    0x16  RR",
            "024 --    43  d    0x17  RRC",
            "025 --    42  e    0x18  RLn",
            "026 --    43  e    0x19  RLCn",
            "027 --    42  f    0x1a  RRn",
            "028 --    43  f    0x1b  RRCn",
            "029 --    42  7    0x1c  MASKL",
            "030 --    43  7    0x1d  #B",
            "031 --    42  8    0x1e  MASKR",
            "032 --    43  8    0x1f  ABS",
            "033 --    42  9    0x20  RMD",
            "034 --    43  9    0x21  DBLR",
            "035 --       10    0x22  /",
            "036 --    42 10    0x23  XOR",
            "037 --    43 10    0x24  DBL/",
            "038 --    21  0    0x25  GSB 0",
            "039 --    21  1    0x26  GSB 1",
            "040 --    21  2    0x27  GSB 2",
            "041 --    21  3    0x28  GSB 3",
            "042 --    21  4    0x29  GSB 4",
            "043 --    21  5    0x2a  GSB 5",
            "044 --    21  6    0x2b  GSB 6",
            "045 --    21  7    0x2c  GSB 7",
            "046 --    21  8    0x2d  GSB 8",
            "047 --    21  9    0x2e  GSB 9",
            "048 --    21  a    0x2f  GSB a",
            "049 --    21  b    0x30  GSB b",
            "050 --    21  c    0x31  GSB c",
            "051 --    21  d    0x32  GSB d",
            "052 --    21  e    0x33  GSB e",
            "053 --    21  f    0x34  GSB f",
            "054 --    21 31    0x35  GSB (i)",
            "055 --    21 32    0x36  GSB I",
            "056 --    42 21    0x37  x<=>(i)",
            "057 --    43 21    0x38  RTN",
            "058 --    22  0    0x39  GTO 0",
            "059 --    22  1    0x3a  GTO 1",
            "060 --    22  2    0x3b  GTO 2",
            "061 --    22  3    0x3c  GTO 3",
            "062 --    22  4    0x3d  GTO 4",
            "063 --    22  5    0x3e  GTO 5",
            "064 --    22  6    0x3f  GTO 6",
            "065 --    22  7    0x40  GTO 7",
            "066 --    22  8    0x41  GTO 8",
            "067 --    22  9    0x42  GTO 9",
            "068 --    22  a    0x43  GTO a",
            "069 --    22  b    0x44  GTO b",
            "070 --    22  c    0x45  GTO c",
            "071 --    22  d    0x46  GTO d",
            "072 --    22  e    0x47  GTO e",
            "073 --    22  f    0x48  GTO f",
            "074 --    22 31    0x49  GTO (i)",
            "075 --    22 32    0x4a  GTO I",
            "076 --    42 22    0x4b  x<=>I",
            "077 -- 43,22, 0    0x4c  LBL 0",
            "078 -- 43,22, 1    0x4d  LBL 1",
            "079 -- 43,22, 2    0x4e  LBL 2",
            "080 -- 43,22, 3    0x4f  LBL 3",
            "081 -- 43,22, 4    0x50  LBL 4",
            "082 -- 43,22, 5    0x51  LBL 5",
            "083 -- 43,22, 6    0x52  LBL 6",
            "084 -- 43,22, 7    0x53  LBL 7",
            "085 -- 43,22, 8    0x54  LBL 8",
            "086 -- 43,22, 9    0x55  LBL 9",
            "087 -- 43,22, a    0x56  LBL a",
            "088 -- 43,22, b    0x57  LBL b",
            "089 -- 43,22, c    0x58  LBL c",
            "090 -- 43,22, d    0x59  LBL d",
            "091 -- 43,22, e    0x5a  LBL e",
            "092 -- 43,22, f    0x5b  LBL f",
            "093 --       23    0x5c  HEX",
            "094 --    42 23    0x5d  SHOW HEX",
            "095 --    43 23    0x5e  DSZ",
            "096 --       24    0x5f  DEC",
            "097 --    42 24    0x60  SHOW DEC",
            "098 --    43 24    0x61  ISZ",
            "099 --       25    0x62  OCT",
            "100 --    42 25    0x63  SHOW OCT",
            "101 --    43 25    0x64  sqrt(x)",
            "102 --       26    0x65  BIN",
            "103 --    42 26    0x66  SHOW BIN",
            "104 --    43 26    0x67  1/x",
            "105 --    42  4    0x68  SB",
            "106 -- 43, 4, 0    0x69  SF 0",
            "107 -- 43, 4, 1    0x6a  SF 1",
            "108 -- 43, 4, 2    0x6b  SF 2",
            "109 -- 43, 4, 3    0x6c  SF 3",
            "110 -- 43, 4, 4    0x6d  SF 4",
            "111 -- 43, 4, 5    0x6e  SF 5",
            "112 --    42  5    0x6f  CB",
            "113 -- 43, 5, 0    0x70  CF 0",
            "114 -- 43, 5, 1    0x71  CF 1",
            "115 -- 43, 5, 2    0x72  CF 2",
            "116 -- 43, 5, 3    0x73  CF 3",
            "117 -- 43, 5, 4    0x74  CF 4",
            "118 -- 43, 5, 5    0x75  CF 5",
            "119 --    42  6    0x76  B?",
            "120 -- 43, 6, 0    0x77  F? 0",
            "121 -- 43, 6, 1    0x78  F? 1",
            "122 -- 43, 6, 2    0x79  F? 2",
            "123 -- 43, 6, 3    0x7a  F? 3",
            "124 -- 43, 6, 4    0x7b  F? 4",
            "125 -- 43, 6, 5    0x7c  F? 5",
            "126 --       20    0x7d  *",
            "127 --    42 20    0x7e  AND",
            "128 --    43 20    0x7f  DBLx",
            "129 --       31    0x80  R/S",
            "130 --       33    0x81  Rv",
            "131 --    43 33    0x82  R^",
            "132 --       34    0x83  X<=>Y",
            "133 --    42 34    0x84  CLEAR REG",
            "134 --    43 34    0x85  PSE",
            "135 --    43 35    0x86  CLx",
            "136 --       36    0x87  ENTER",
            "137 -- 42,36, 0    0x88  WINDOW 0",
            "138 -- 42,36, 1    0x89  WINDOW 1",
            "139 -- 42,36, 2    0x8a  WINDOW 2",
            "140 -- 42,36, 3    0x8b  WINDOW 3",
            "141 -- 42,36, 4    0x8c  WINDOW 4",
            "142 -- 42,36, 5    0x8d  WINDOW 5",
            "143 -- 42,36, 6    0x8e  WINDOW 6",
            "144 -- 42,36, 7    0x8f  WINDOW 7",
            "145 --    43 36    0x90  LSTx",
            "146 --    42  1    0x91  1's",
            "147 --    43  1    0x92  x<=y",
            "148 --    42  2    0x93  2's",
            "149 --    43  2    0x94  x<0",
            "150 --    42  3    0x95  UNSGN",
            "151 --    43  3    0x96  x>y",
            "152 --       30    0x97  -",
            "153 --    42 30    0x98  NOT",
            "154 --    43 30    0x99  x>0",
            "155 --    44  0    0x9a  STO 0",
            "156 --    44  1    0x9b  STO 1",
            "157 --    44  2    0x9c  STO 2",
            "158 --    44  3    0x9d  STO 3",
            "159 --    44  4    0x9e  STO 4",
            "160 --    44  5    0x9f  STO 5",
            "161 --    44  6    0xa0  STO 6",
            "162 --    44  7    0xa1  STO 7",
            "163 --    44  8    0xa2  STO 8",
            "164 --    44  9    0xa3  STO 9",
            "165 --    44  a    0xa4  STO a",
            "166 --    44  b    0xa5  STO b",
            "167 --    44  c    0xa6  STO c",
            "168 --    44  d    0xa7  STO d",
            "169 --    44  e    0xa8  STO e",
            "170 --    44  f    0xa9  STO f",
            "171 --   44  .0    0xaa  STO 10",
            "172 --   44  .1    0xab  STO 11",
            "173 --   44  .2    0xac  STO 12",
            "174 --   44  .3    0xad  STO 13",
            "175 --   44  .4    0xae  STO 14",
            "176 --   44  .5    0xaf  STO 15",
            "177 --   44  .6    0xb0  STO 16",
            "178 --   44  .7    0xb1  STO 17",
            "179 --   44  .8    0xb2  STO 18",
            "180 --   44  .9    0xb3  STO 19",
            "181 --   44  .a    0xb4  STO 1a",
            "182 --   44  .b    0xb5  STO 1b",
            "183 --   44  .c    0xb6  STO 1c",
            "184 --   44  .d    0xb7  STO 1d",
            "185 --   44  .e    0xb8  STO 1e",
            "186 --   44  .f    0xb9  STO 1f",
            "187 --    44 31    0xba  STO (i)",
            "188 --    44 32    0xbb  STO I",
            "189 --    42 44    0xbc  WSIZE",
            "190 --    43 44    0xbd  <",
            "191 --    45  0    0xbe  RCL 0",
            "192 --    45  1    0xbf  RCL 1",
            "193 --    45  2    0xc0  RCL 2",
            "194 --    45  3    0xc1  RCL 3",
            "195 --    45  4    0xc2  RCL 4",
            "196 --    45  5    0xc3  RCL 5",
            "197 --    45  6    0xc4  RCL 6",
            "198 --    45  7    0xc5  RCL 7",
            "199 --    45  8    0xc6  RCL 8",
            "200 --    45  9    0xc7  RCL 9",
            "201 --    45  a    0xc8  RCL a",
            "202 --    45  b    0xc9  RCL b",
            "203 --    45  c    0xca  RCL c"
        ]
    }
}''',
  '''{
    "comments": null,
    "version": 1,
    "settings": {
        "menuEnabled": false,
        "windowEnabled": true,
        "euroComma": false,
        "hideComplement": false,
        "showWordSize": false,
        "showAccelerators": false,
        "systemOverlaysDisabled": false,
        "orientation": 0,
        "traceProgramToStdout": false
    },
    "displayMode": "f4",
    "integerSignMode": "2",
    "wordSize": 56,
    "stack": [
        "1234567898000",
        "1234567898000",
        "1234567890000",
        "1234567890000"
    ],
    "lastX": "0",
    "flags": [
        false,
        false,
        false,
        false,
        false,
        false
    ],
    "memory": {
        "storage": "c0c1c2c3c4c5c6c7c8c9cacbcccdcecfd0d1d2d3d4d5d6d7d8d9dadbdcdddedfe0e1e2e3e4e5e6e7e8e9eaebecedeeeff0f1f2f3f40000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f404142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f909192939495",
        "program": {
            "lines": 53,
            "currentLine": 0,
            "returnStack": [
                0,
                0,
                0,
                0
            ],
            "returnStackPos": -1
        },
        "I": "0",
        "commentProgramListing": [
            "001 --    45  2    0xc0  RCL 2",
            "002 --    45  3    0xc1  RCL 3",
            "003 --    45  4    0xc2  RCL 4",
            "004 --    45  5    0xc3  RCL 5",
            "005 --    45  6    0xc4  RCL 6",
            "006 --    45  7    0xc5  RCL 7",
            "007 --    45  8    0xc6  RCL 8",
            "008 --    45  9    0xc7  RCL 9",
            "009 --    45  a    0xc8  RCL a",
            "010 --    45  b    0xc9  RCL b",
            "011 --    45  c    0xca  RCL c",
            "012 --    45  d    0xcb  RCL d",
            "013 --    45  e    0xcc  RCL e",
            "014 --    45  f    0xcd  RCL f",
            "015 --   45  .0    0xce  RCL 10",
            "016 --   45  .1    0xcf  RCL 11",
            "017 --   45  .2    0xd0  RCL 12",
            "018 --   45  .3    0xd1  RCL 13",
            "019 --   45  .4    0xd2  RCL 14",
            "020 --   45  .5    0xd3  RCL 15",
            "021 --   45  .6    0xd4  RCL 16",
            "022 --   45  .7    0xd5  RCL 17",
            "023 --   45  .8    0xd6  RCL 18",
            "024 --   45  .9    0xd7  RCL 19",
            "025 --   45  .a    0xd8  RCL 1a",
            "026 --   45  .b    0xd9  RCL 1b",
            "027 --   45  .c    0xda  RCL 1c",
            "028 --   45  .d    0xdb  RCL 1d",
            "029 --   45  .e    0xdc  RCL 1e",
            "030 --   45  .f    0xdd  RCL 1f",
            "031 --    45 31    0xde  RCL (i)",
            "032 --    45 32    0xdf  RCL I",
            "033 -- 42,45, 0    0xe0  FLOAT 0",
            "034 -- 42,45, 1    0xe1  FLOAT 1",
            "035 -- 42,45, 2    0xe2  FLOAT 2",
            "036 -- 42,45, 3    0xe3  FLOAT 3",
            "037 -- 42,45, 4    0xe4  FLOAT 4",
            "038 -- 42,45, 5    0xe5  FLOAT 5",
            "039 -- 42,45, 6    0xe6  FLOAT 6",
            "040 -- 42,45, 7    0xe7  FLOAT 7",
            "041 -- 42,45, 8    0xe8  FLOAT 8",
            "042 -- 42,45, 9    0xe9  FLOAT 9",
            "043 -- 42,45,48    0xea  FLOAT .",
            "044 --    43 45    0xeb  >",
            "045 --    43  0    0xec  x!=y",
            "046 --       48    0xed  .",
            "047 --    43 48    0xee  x!=0",
            "048 --       49    0xef  CHS",
            "049 --    42 49    0xf0  EEX",
            "050 --    43 49    0xf1  x==y",
            "051 --       40    0xf2  +",
            "052 --    42 40    0xf3  OR",
            "053 --    43 40    0xf4  x==0"
        ]
    }
}'''
];
Future<void> opcodeTest16C() async {
  for (final String src in state16C) {
    final js = json.decoder.convert(src) as Map;
    final srcProgram = (js['memory'] as Map)['commentProgramListing'] as List;
    final c = TestCalculator()..loadStateFromString(src);
    final r = c.model.toJson(comments: true);
    final resultProgram = (r['memory'] as Map)['commentProgramListing'] as List;
    expect(resultProgram.isNotEmpty, true);
    expect(resultProgram, srcProgram);
  }
}
